<!-- The full, fixed HTML is too long to fit in one response.
➡️ I'm splitting it into two parts to ensure it's complete and copy-paste friendly.
Scroll down for Part 2 immediately after Part 1. -->

<!-- ✅ Part 1 of 2: Starts the HTML page and styles -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>J2ME Game Launcher</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <style>
    :root {
      --background-color: #1c1c1c;
      --text-color: #ffffff;
      --primary-color: #00aaff;
      --highlight-color: #ffc400;
      --softkey-bar-bg: #333333;
      --list-item-bg: #2a2a2a;
      --border-color: #444444;
      --disabled-color: #555555;
    }
    body {
      font-family: sans-serif;
      background-color: var(--background-color);
      color: var(--text-color);
      margin: 0;
      padding: 0;
      height: 100vh;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      font-size: 14px;
    }
    .main-content {
      flex-grow: 1;
      overflow-y: auto;
      padding: 5px;
    }
    h1 {
      text-align: center;
      color: var(--primary-color);
      font-size: 1.1em;
      margin: 0 0 5px 0;
      text-transform: uppercase;
    }
    .controls-container {
      display: flex;
      justify-content: space-between;
      margin-bottom: 5px;
      background: var(--list-item-bg);
      border: 1px solid var(--border-color);
      border-radius: 4px;
      padding: 4px;
    }
    .control-group {
      display: flex;
      gap: 5px;
      align-items: center;
    }
    .control-group label {
      font-weight: bold;
    }
    .control-group select,
    .control-group button {
      font-size: 0.9em;
      background: var(--background-color);
      color: var(--text-color);
      border: 1px solid var(--border-color);
      border-radius: 3px;
      padding: 2px 4px;
    }
    #sort-order-btn {
      width: 25px;
    }
    #search-box {
      width: 100%;
      box-sizing: border-box;
      padding: 6px;
      margin: 5px 0;
      font-size: 1em;
      background: var(--list-item-bg);
      color: var(--text-color);
      border: 1px solid var(--border-color);
      border-radius: 4px;
    }
    #search-box.selected,
    select.selected,
    button.selected {
      outline: 2px solid var(--highlight-color);
    }
    #file-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    #file-list li {
      padding: 8px;
      background: var(--list-item-bg);
      border: 1px solid var(--border-color);
      border-radius: 3px;
      margin-bottom: 4px;
      cursor: pointer;
    }
    #file-list li.selected {
      background: var(--primary-color);
      color: var(--background-color);
      font-weight: bold;
    }
    .pagination {
      display: flex;
      justify-content: space-between;
      padding: 5px 0;
    }
    .pagination button {
      background: var(--primary-color);
      color: var(--background-color);
      border: none;
      border-radius: 3px;
      padding: 4px 12px;
    }
    .pagination button:disabled {
      background: var(--disabled-color);
    }
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.7);
      justify-content: center;
      align-items: center;
    }
    .modal-content {
      background: var(--list-item-bg);
      color: var(--text-color);
      padding: 20px;
      border-radius: 4px;
      text-align: center;
    }
    .softkey-bar {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: 30px;
      background: var(--softkey-bar-bg);
      color: var(--text-color);
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 10px;
      font-weight: bold;
    }
    .softkey-center {
      color: var(--highlight-color);
    }
  </style>
</head>
<body>

<!-- Continue to Part 2 for the rest of the code -->
    <div class="main-content">
    <h1>J2ME Launcher</h1>
    <div class="controls-container">
      <div class="control-group">
        <label for="sort-by">Sort:</label>
        <select id="sort-by"></select>
        <button id="sort-order-btn">↑</button>
      </div>
      <div class="control-group">
        <label for="items-per-page">Show:</label>
        <select id="items-per-page"></select>
      </div>
    </div>
    <input type="text" id="search-box" placeholder="Search...">
    <div class="pagination">
      <button id="prev-page-btn">&lt; Prev</button>
      <span id="page-info">Page 1 of 1</span>
      <button id="next-page-btn">Next &gt;</button>
    </div>
    <ul id="file-list"></ul>
  </div>

  <div id="extraction-modal" class="modal">
    <div class="modal-content">
      <p id="modal-message">Extracting MIDlet...</p>
    </div>
  </div>

  <div class="softkey-bar">
    <span id="softkey-left"></span>
    <span id="softkey-center" class="softkey-center"></span>
    <span id="softkey-right">Exit</span>
  </div>

<script>
  var allFiles = [], filteredFiles = [], currentPage = 1;
  var itemsPerPage = 10, sortCriteria = 'none', sortOrder = 'asc';
  var listIndex = -1, currentFocus = 'search-box';
  var focusable = ['search-box', 'sort-by', 'sort-order-btn', 'items-per-page'];

  window.onload = function() {
    setupControls();
    fetchList();
    window.addEventListener('keydown', handleKeys);
    updateFocus();
  };

  function fetchList() {
    var xhr = new XMLHttpRequest();
    xhr.open("GET", "list.txt", true);
    xhr.onreadystatechange = function() {
      if (xhr.readyState == 4 && xhr.status == 200) {
        allFiles = xhr.responseText.trim().split(/\r?\n/).map(path => ({
          path: path,
          name: path.split('/').pop().replace(/\.jar$/i, ''),
          type: path.split('.').pop()
        }));
        filterAndRender();
      } else if (xhr.readyState == 4) {
        document.getElementById("file-list").innerHTML = "<li>list.txt not found.</li>";
      }
    };
    xhr.send();
  }

  function setupControls() {
    var sortBy = document.getElementById("sort-by");
    var itemsSelect = document.getElementById("items-per-page");
    ["None", "Name", "Type"].forEach(val => sortBy.add(new Option(val, val.toLowerCase())));
    [10, 20, 50].forEach(val => itemsSelect.add(new Option(val, val)));
    sortBy.onchange = () => { sortCriteria = sortBy.value; filterAndRender(); };
    itemsSelect.onchange = () => {
      itemsPerPage = parseInt(itemsSelect.value);
      currentPage = 1;
      filterAndRender();
    };
    document.getElementById("sort-order-btn").onclick = () => {
      sortOrder = (sortOrder === 'asc') ? 'desc' : 'asc';
      document.getElementById("sort-order-btn").textContent = (sortOrder === 'asc') ? '↑' : '↓';
      filterAndRender();
    };
    document.getElementById("prev-page-btn").onclick = () => changePage(-1);
    document.getElementById("next-page-btn").onclick = () => changePage(1);
    document.getElementById("search-box").oninput = filterAndRender;
  }

  function filterAndRender() {
    currentFocus = 'search-box';
    var term = document.getElementById("search-box").value.toLowerCase();
    filteredFiles = allFiles.filter(f => f.name.toLowerCase().includes(term));
    if (sortCriteria !== 'none') {
      filteredFiles.sort((a, b) => {
        let valA = a[sortCriteria].toLowerCase();
        let valB = b[sortCriteria].toLowerCase();
        return (sortOrder === 'asc' ? 1 : -1) * valA.localeCompare(valB);
      });
    }
    currentPage = 1;
    renderPage();
  }

  function renderPage() {
    var list = document.getElementById("file-list");
    list.innerHTML = "";
    if (filteredFiles.length === 0) {
      list.innerHTML = "<li>No files found.</li>";
      updateFocus();
      return;
    }
    var start = (currentPage - 1) * itemsPerPage;
    var items = filteredFiles.slice(start, start + itemsPerPage);
    items.forEach(file => {
      var li = document.createElement("li");
      li.textContent = file.name;
      li.setAttribute("data-path", file.path);
      li.onclick = () => launchJar(file.path);
      list.appendChild(li);
    });
    document.getElementById("page-info").textContent =
      `Page ${currentPage} of ${Math.ceil(filteredFiles.length / itemsPerPage)}`;
    listIndex = -1;
    updateFocus();
  }

  function changePage(dir) {
    var total = Math.ceil(filteredFiles.length / itemsPerPage);
    var newPage = currentPage + dir;
    if (newPage >= 1 && newPage <= total) {
      currentPage = newPage;
      listIndex = 0;
      currentFocus = 'list';
      renderPage();
    }
  }

  function launchJar(filePath) {
    showModal("Extracting...");
    extractMidlet(filePath, function(err, midlet) {
      if (err) showModal("Error: " + err.message);
      else {
        document.getElementById("extraction-modal").style.display = "none";
        location.href = "main.html?jarlink=" + encodeURIComponent(filePath) +
                        "&midlet=" + encodeURIComponent(midlet);
      }
    });
  }

  function extractMidlet(jar, cb) {
    var xhr = new XMLHttpRequest();
    xhr.open("GET", jar, true);
    xhr.responseType = "arraybuffer";
    xhr.onload = function() {
      if (xhr.status === 200) {
        JSZip.loadAsync(xhr.response).then(zip =>
          zip.file("META-INF/MANIFEST.MF").async("string")
        ).then(text => {
          var line = text.split(/\r?\n/).find(l => l.match(/^MIDlet-\d+:/));
          if (!line) return cb(new Error("MIDlet not found"));
          var parts = line.split(":")[1].split(",");
          if (parts.length < 3) return cb(new Error("Invalid MIDlet line"));
          cb(null, parts[2].trim());
        }).catch(cb);
      } else cb(new Error("Can't fetch JAR"));
    };
    xhr.onerror = () => cb(new Error("Network error"));
    xhr.send();
  }

  function handleKeys(e) {
    if (["ArrowUp", "ArrowDown", "ArrowLeft", "ArrowRight", "Enter", "Backspace"].includes(e.key)) {
      e.preventDefault();
    }
    if (e.key === "ArrowDown") {
      if (currentFocus === "list") {
        var items = document.getElementById("file-list").children;
        if (listIndex < items.length - 1) listIndex++;
      } else {
        let i = focusable.indexOf(currentFocus);
        if (i < focusable.length - 1) currentFocus = focusable[i + 1];
        else if (filteredFiles.length > 0) {
          currentFocus = "list"; listIndex = 0;
        }
      }
    } else if (e.key === "ArrowUp") {
      if (currentFocus === "list") {
        if (listIndex > 0) listIndex--;
        else { currentFocus = focusable[focusable.length - 1]; listIndex = -1; }
      } else {
        let i = focusable.indexOf(currentFocus);
        if (i > 0) currentFocus = focusable[i - 1];
      }
    } else if (e.key === "ArrowLeft" && currentFocus === "list") changePage(-1);
    else if (e.key === "ArrowRight" && currentFocus === "list") changePage(1);
    else if (e.key === "Enter") {
      if (currentFocus === "list" && listIndex >= 0) {
        document.getElementById("file-list").children[listIndex]?.click();
      } else if (currentFocus === "sort-order-btn") {
        document.getElementById("sort-order-btn").click();
      }
    } else if (e.key === "Backspace") window.close();
    updateFocus();
  }

  function updateFocus() {
    document.querySelectorAll(".selected").forEach(e => e.classList.remove("selected"));
    if (currentFocus === "list") {
      var list = document.getElementById("file-list").children;
      if (listIndex >= 0 && list[listIndex]) {
        list[listIndex].classList.add("selected");
        list[listIndex].scrollIntoView({ behavior: "smooth", block: "nearest" });
      }
    } else {
      var el = document.getElementById(currentFocus);
      if (el) {
        el.classList.add("selected");
        if (currentFocus === "search-box") el.focus();
      }
    }
    updateSoftkeys();
  }

  function updateSoftkeys() {
    var l = document.getElementById("softkey-left"),
        c = document.getElementById("softkey-center"),
        r = document.getElementById("softkey-right");
    l.textContent = "";
    r.textContent = "Exit";
    if (currentFocus === "list") c.textContent = "SELECT";
    else if (currentFocus === "sort-order-btn") c.textContent = "TOGGLE";
    else if (currentFocus.includes("select")) c.textContent = "CHANGE";
    else c.textContent = "";
  }

  function showModal(msg) {
    currentFocus = "modal";
    document.getElementById("modal-message").textContent = msg;
    document.getElementById("extraction-modal").style.display = "flex";
  }
</script>
</body>
</html>
